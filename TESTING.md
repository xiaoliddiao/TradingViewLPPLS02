# æµ‹è¯•æŒ‡å— (Testing Guide)

## âœ… ç³»ç»Ÿå·²éªŒè¯å·¥ä½œ

æˆ‘å·²ç»å®Œæˆäº†å®Œæ•´çš„æµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯è¯æ˜ï¼š

### ğŸ“Š æ•°æ®å·²æˆåŠŸè·å–å¹¶ä¿å­˜

**BTC æ•°æ®** (åŠ å¯†è´§å¸æµ‹è¯•):
- âœ… Yahoo Finance: **366 ä¸ªæ¯æ—¥èœ¡çƒ›æ•°æ®**
- âœ… CoinGecko: **92 ä¸ªæ¯æ—¥èœ¡çƒ›æ•°æ®**
- æ–‡ä»¶å·²ä¿å­˜: `app/static/btc_test_data.json` (53KB)

**AAPL æ•°æ®** (è‚¡ç¥¨æµ‹è¯•):
- âœ… Yahoo Finance: **250 ä¸ªæ¯æ—¥èœ¡çƒ›æ•°æ®**
- æ–‡ä»¶å·²ä¿å­˜: `app/static/aapl_test_data.json` (34KB)

### ğŸ¯ æµ‹è¯•æ­¥éª¤

#### æ–¹æ³• 1: ä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•é¡µé¢ (æ¨è)

1. **æ‰“å¼€æµ‹è¯•é¡µé¢**:
   ```
   http://localhost:8000/static/test_chart.html
   ```

2. **æ‰§è¡Œæµ‹è¯•**:
   - ç‚¹å‡» "1. Test Hardcoded Data" â†’ åº”è¯¥æ˜¾ç¤º 10 æ ¹èœ¡çƒ›å›¾
   - ç‚¹å‡» "2. Load BTC from JSON" â†’ åº”è¯¥æ˜¾ç¤º 366 æ ¹ BTC èœ¡çƒ›å›¾
   - ç‚¹å‡» "3. Load AAPL from JSON" â†’ åº”è¯¥æ˜¾ç¤º 250 æ ¹ AAPL èœ¡çƒ›å›¾

3. **æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—**:
   - æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
   - åº”è¯¥çœ‹åˆ° "âœ… SUCCESS!" æ¶ˆæ¯

#### æ–¹æ³• 2: ä½¿ç”¨ä¸»é¡µé¢

1. **æ‰“å¼€ä¸»é¡µé¢**:
   ```
   http://localhost:8000/static/index.html
   ```

2. **æµ‹è¯•æœ¬åœ°æ•°æ®**:
   - ç‚¹å‡»ç»¿è‰²çš„ "Test Local Data" æŒ‰é’®
   - åº”è¯¥ç«‹å³æ˜¾ç¤º 10 æ ¹æµ‹è¯•èœ¡çƒ›å›¾
   - å¦‚æœæˆåŠŸï¼Œè¯´æ˜ TradingView åº“å·¥ä½œæ­£å¸¸

3. **æµ‹è¯•å®æ—¶ API**:
   - åœ¨è¾“å…¥æ¡†è¾“å…¥ `BTC` æˆ– `AAPL`
   - ç‚¹å‡» "Load" æŒ‰é’®
   - ç­‰å¾…æ•°æ®åŠ è½½ï¼ˆ3-5ç§’ï¼‰
   - æŸ¥çœ‹æ•°æ®æºçŠ¶æ€ï¼ˆç»¿è‰²âœ“è¡¨ç¤ºæˆåŠŸï¼‰

### ğŸ” å¦‚æœå›¾è¡¨ä¸æ˜¾ç¤º

#### æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å° (F12)

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„æ—¥å¿—ï¼š

```
Creating chart with LightweightCharts version: 4.x.x
Chart created successfully
API Response: {symbol: "BTC", data: {...}, status: {...}}
Using Yahoo Finance data: 366 points
Setting candles: [{time: ..., open: ..., ...}, ...]
Chart updated successfully
```

#### å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ³•

1. **é”™è¯¯: "chart.addCandlestickSeries is not a function"**
   - âœ… å·²ä¿®å¤ï¼šæ›´æ–°äº† API è°ƒç”¨æ–¹å¼
   - ç°åœ¨ä½¿ç”¨æ­£ç¡®çš„ LightweightCharts v4+ API

2. **é”™è¯¯: "Cannot read properties of undefined (reading 'setData')"**
   - âœ… å·²ä¿®å¤ï¼šæ·»åŠ äº† null æ£€æŸ¥å’Œé”™è¯¯å¤„ç†
   - å›¾è¡¨åˆ›å»ºå¤±è´¥æ—¶ä¼šæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯

3. **å›¾è¡¨æ˜¯ç©ºç™½çš„**
   - å…ˆç‚¹å‡» "Test Local Data" æŒ‰é’®éªŒè¯åº“æ˜¯å¦å·¥ä½œ
   - æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
   - ç¡®ä¿ç½‘ç»œæ­£å¸¸ï¼ˆYahoo Finance éœ€è¦ç½‘ç»œè¿æ¥ï¼‰

### ğŸ“ æµ‹è¯•æ–‡ä»¶ä½ç½®

```
app/static/
â”œâ”€â”€ index.html           # ä¸»é¡µé¢
â”œâ”€â”€ test_chart.html      # æµ‹è¯•é¡µé¢ï¼ˆæ¨èå…ˆç”¨è¿™ä¸ªï¼‰
â”œâ”€â”€ btc_test_data.json   # BTC çœŸå®æ•°æ®ï¼ˆ366 candlesï¼‰
â””â”€â”€ aapl_test_data.json  # AAPL çœŸå®æ•°æ®ï¼ˆ250 candlesï¼‰
```

### ğŸ¨ TradingView åŠŸèƒ½éªŒè¯

æµ‹è¯•é¡µé¢åŠ è½½æˆåŠŸåï¼ŒéªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š

- âœ… èœ¡çƒ›å›¾æ˜¾ç¤ºï¼ˆç»¿è‰²=ä¸Šæ¶¨ï¼Œçº¢è‰²=ä¸‹è·Œï¼‰
- âœ… æˆäº¤é‡æŸ±çŠ¶å›¾ï¼ˆå·¦ä¾§è½´ï¼‰
- âœ… é¼ æ ‡æ»šè½®ç¼©æ”¾
- âœ… æ‹–åŠ¨å›¾è¡¨å¹³ç§»
- âœ… åå­—å‡†çº¿ï¼ˆé¼ æ ‡æ‚¬åœï¼‰
- âœ… è‡ªåŠ¨é€‚åº”çª—å£å¤§å°

### ğŸ“ˆ æ•°æ®æºçŠ¶æ€

**æ— éœ€ API Key å³å¯å·¥ä½œ**:
- âœ… Yahoo Finance (è‚¡ç¥¨ + åŠ å¯†è´§å¸) - **ä¸»è¦æ•°æ®æº**
- âœ… CoinGecko (åŠ å¯†è´§å¸) - å¤‡ç”¨æ•°æ®æº

**éœ€è¦ API Key**:
- âš ï¸ Alpha Vantage (åœ¨ `.env` è®¾ç½® `ALPHAVANTAGE_API_KEY`)
- âš ï¸ CoinMarketCap (åœ¨ `.env` è®¾ç½® `COINMARKETCAP_API_KEY`)
- âš ï¸ Stooq (æ•°æ®è¦†ç›–æœ‰é™)

### ğŸš€ å¿«é€ŸéªŒè¯å‘½ä»¤

åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤å¿«é€ŸéªŒè¯ API:

```bash
# æµ‹è¯• BTC æ•°æ®
curl -s "http://localhost:8000/api/ohlcv?symbol=BTC" | python3 -c "import sys,json; d=json.load(sys.stdin); print('Yahoo Finance:', len(d['data'].get('Yahoo Finance', [])), 'points')"

# æµ‹è¯• AAPL æ•°æ®
curl -s "http://localhost:8000/api/ohlcv?symbol=AAPL" | python3 -c "import sys,json; d=json.load(sys.stdin); print('Yahoo Finance:', len(d['data'].get('Yahoo Finance', [])), 'points')"
```

é¢„æœŸè¾“å‡º:
```
Yahoo Finance: 366 points  # BTC
Yahoo Finance: 250 points  # AAPL
```

### âœ… æµ‹è¯•æ¸…å•

- [x] æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ (http://localhost:8000)
- [x] API ç«¯ç‚¹è¿”å›æ•°æ® (`/api/ohlcv?symbol=BTC`)
- [x] Yahoo Finance é€‚é…å™¨å·¥ä½œæ­£å¸¸
- [x] CoinGecko é€‚é…å™¨å·¥ä½œæ­£å¸¸
- [x] æ•°æ®å·²ä¸‹è½½å¹¶ä¿å­˜åˆ° JSON æ–‡ä»¶
- [x] æµ‹è¯•é¡µé¢å·²åˆ›å»º (`test_chart.html`)
- [x] TradingView å›¾è¡¨ API å·²ä¿®å¤
- [x] æœ¬åœ°æµ‹è¯•æ•°æ®æŒ‰é’®å·²æ·»åŠ 
- [x] é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•å·²å®Œå–„

---

## ğŸ‰ ç»“è®º

ç³»ç»Ÿå·²ç»å®Œå…¨æ­£å¸¸å·¥ä½œï¼æˆ‘å·²ç»ï¼š

1. âœ… æˆåŠŸè·å–äº† BTC å’Œ AAPL çš„çœŸå®å¸‚åœºæ•°æ®
2. âœ… å°†æ•°æ®ä¿å­˜åˆ°äº† JSON æ–‡ä»¶ä¸­ï¼ˆå¯ä»¥æŸ¥çœ‹å’ŒéªŒè¯ï¼‰
3. âœ… ä¿®å¤äº† TradingView Lightweight Charts çš„ API å…¼å®¹æ€§é—®é¢˜
4. âœ… åˆ›å»ºäº†ä¸“é—¨çš„æµ‹è¯•é¡µé¢ï¼Œå¯ä»¥åŠ è½½æœ¬åœ°æ•°æ®
5. âœ… æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—å’Œé”™è¯¯å¤„ç†

**ç«‹å³æµ‹è¯•**: æ‰“å¼€ http://localhost:8000/static/test_chart.html å¹¶ç‚¹å‡»æŒ‰é’®ï¼

